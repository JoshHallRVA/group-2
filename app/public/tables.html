<!DOCTYPE html>
<html lang="en">
	<head>
		<title>HypeBeast</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link
			rel="stylesheet"
			href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
		/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
		
    <link rel="stylesheet" type="text/css" href="/app/public/assets/style.css" />
	</head>
	<body>
		<div class="jumbotron">
			<div class="container text-center">
				<h1>
					<img
						src="https://fontmeme.com/permalink/200827/6de3b13b6bc34814bd6ae29dbc037e4e.png"
						alt="logo"
					/>
				</h1>
				<p class="tagline">Your Sneakerhead Headquarters</p>
			</div>
		</div>

		<nav class="navbar navbar-inverse">
			<div class="container-fluid">
				<div class="navbar-header">
					<button
						type="button"
						class="navbar-toggle"
						data-toggle="collapse"
						data-target="#myNavbar"
					>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="myNavbar">
					<ul class="nav navbar-nav">
						<li class="active"><a href="/">Home</a></li>
						<li><a href="/tables">For Sale</a></li>
						<li><a href="/reserve">Upload Sneaks</a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
					</ul>
				</div>
			</div>
    </nav>

			<div class="row">
				<div class="col-lg-12">
					<!-- Current Tables in Use -->
					<div class="card">
						<div class="card-header">
							<h4>Current HypeBeasts</h4>
						</div>
						<div class="card-body">
							<ul id="tableList" class="list-group"></ul>
						</div>
					</div>

					<!-- Waiting List Card -->
					<div class="card mt-4">
						<div class="card-header">
							<h4></h4>
						</div>
						<div class="card-body">
							<ul id="waitList" class="list-group"></ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>

	<!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS LOADED FROM OUR SERVER -->
	<script type="text/javascript">
		// In this code, jQuery is used to "download" the data from our server
		// We then dynamically display this content in our table. This is very similar to the group projects you just completed.
		// It's also very similar to the NYT search application. In fact, I copied a ton of code from there.

		function runTableQuery() {
			// The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
			$.ajax({ url: "/api/tables", method: "GET" }).then(function (
				tableData
			) {
				// Here we then log the tableData to console, where it will show up as an object.
				console.log(tableData);
				console.log("------------------------------------");

				// Loop through and display each of the customers
				for (var i = 0; i < tableData.length; i++) {
					// Get a reference to the tableList element and populate it with tables
					var tableList = $("#tableList");

					// Then display the fields in the HTML (Section Name, Date, URL)
					var listItem = $("<li class='list-group-item mt-4'>");

					listItem.append(
						$("<h2>").text("HypBeast! #" + (i + 1)),
						$("<hr>"),
						$("<h2>").text("Name: " + tableData[i].customerName),
						$("<h2>").text("Email: " + tableData[i].customerEmail),
						$("<h2>").text("Style: " + tableData[i].customerStyle),
						$("<h2>").text("Brand: " + tableData[i].customerBrand),
						$("<h2>").text("ShoeSize: " + tableData[i].customerShoeSize),
						$("<h2>").text("Price: " + tableData[i].customerPrice)
					);

					tableList.append(listItem);
				}
			});
		}

		

		// This function resets all of the data in our tables. This is intended to let you restart a demo.
		function clearTable() {
			alert("Clearing...");

			// Clear the tables on the server and then empty the elements on the client
			$.ajax({ url: "/api/clear", method: "POST" }).then(function () {
				$("#waitList").empty();
				$("#tableList").empty();
			});
		}

		$("#clear").on("click", clearTable);

		// Run Queries!
		// ==========================================
		runTableQuery();
		runWaitListQuery();
	</script>
</html>
